---
title: CSS ä¸­çš„ calc()
date: 2020-07-17
cover: https://qiniu.duanxiaogang.cn//20210313172638.jpg
permalink: /calc-in-css
categories:
  - tech
tags:
  - CSS
---

åœ¨ CSS ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ `calc()` å‡½æ•°ç”¨æ¥è¿›è¡ŒåŸºæœ¬çš„æ•°å­¦è¿ç®—ã€‚`calc()` å‡½æ•°ç”¨ä¸€ä¸ªè¡¨è¾¾å¼ä½œä¸ºå®ƒçš„å‚æ•°ï¼Œç”¨è¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœä½œä¸ºå€¼ã€‚

```css
.main-content {
  /* Subtract 80px from 100vh */
  height: calc(100vh - 80px);
}
```

## calc() ç”¨äºå€¼çš„è®¡ç®—

ä¸‹æ–¹æ˜¯è®¾ç½®å€¼çš„å‡ ä¸ªç¤ºä¾‹ï¼š

```css
.el {
  font-size: calc(3vw + 2px);
  width:     calc(100% - 20px);
  height:    calc(100vh - 20px);
  padding:   calc(1vw + 5px);
}
```

```css
.el {
  margin: 10px calc(2vw + 5px);
  border-radius: 15px calc(15px / 3) 4px 2px;
  transition: transform calc(1s - 120ms);
}
```

```css
.el {
  background: #1E88E5 linear-gradient(
    to bottom,
    #1E88E5,
    #1E88E5 calc(50% - 10px),
    #3949AB calc(50% + 10px),
    #3949AB
  );
}
```

## calc() ç”¨äºé•¿åº¦å’Œå…¶ä»–æ•°å­—

`calc()` æ˜¯åŸºäºæ•°å­—çš„ï¼Œä½ ä¸èƒ½ç”¨å®ƒæ¥è®¡ç®—å­—ç¬¦ä¸²ã€‚

```css
.el {
  /* Nope! */
  counter-reset: calc("My " + "counter");
}
.el::before {
  /* Nope! */
  content: calc("Candyman " * 3);
}
```

CSS ä¸­æœ‰å¾ˆå¤šé•¿åº¦å•ä½ï¼Œä¸‹æ–¹çš„è¿™äº›å•ä½éƒ½å¯ä»¥åœ¨ `calc()` ä¸­ä½¿ç”¨ï¼š

---

`px` `%` `em` `rem` `in` `mm` `cm` `pt` `pc` `ex` `ch` `vh` `vw` `vmin` `vmax`

---

ä¹Ÿå¯ä»¥æ¥å—æ— å•ä½çš„æ•°å­—ï¼Œä¾‹å¦‚ `line-heightï¼šcalc(1.2 * 1.2);`
ä»¥åŠè§’åº¦ `transform: rotate(calc(10deg * 5));`

ä½ ä¹Ÿå¯ä»¥ä¸åšä»»ä½•è®¡ç®—ï¼š

```css
.el {
  /* Little weird but OK */
  width: calc(20px);
}
```

## ä¸æ¥å—åª’ä½“æŸ¥è¯¢

`calc()` åœ¨åª’ä½“æŸ¥è¯¢ä¸­å°†æ— æ³•ä½¿ç”¨ã€‚

```css
@media (max-width: 40rem) {
  /* Narrower or exactly 40rem */
}

/* Nope! */
@media (min-width: calc(40rem + 1px)) {
  /* Wider than 40rem */
}
```

## å¯ä»¥æ··åˆå•ä½

è¿™ä¹Ÿè®¸æ˜¯ `calc()` æœ€æœ‰ä»·å€¼çš„åŠŸèƒ½ï¼

```css
/* Percentage units being mixed with pixel units */
width: calc(100% - 20px);
```

å…ƒç´ çš„å®½åº¦è‡³å°‘ä¸º 20 åƒç´ ã€‚

## calc() çš„æ•°å­¦è¿ç®—ç¬¦

1. åŠ å·ï¼ˆ+ï¼‰å’Œå‡å·ï¼ˆ-ï¼‰è¦æ±‚ä¸¤ä¸ªæ•°å­—å‡ä¸ºé•¿åº¦

   ```css
   .el {
     /* Valid ğŸ‘ */
     margin: calc(10px + 10px);

     /* Invalid ğŸ‘ */
     margin: calc(10px + 5);
   }
   ```

   æ— æ•ˆçš„å€¼ä¼šä½¿æ•´ä¸ªå£°æ˜æ— æ•ˆã€‚

2. é™¤æ³•ï¼ˆ/ï¼‰è¦æ±‚é™¤æ•°ä¸èƒ½å¸¦å•ä½å¹¶ä¸”ä¸èƒ½ä¸º 0

   ```css
   .el {
     /* Valid ğŸ‘ */
     margin: calc(30px / 3);

     /* Invalid ğŸ‘ */
     margin: calc(30px / 10px);

     /* Invalid ğŸ‘ (can't divide by 0) */
     margin: calc(30px / 0);
   }
   ```

3. ä¹˜æ³•ï¼ˆ\*ï¼‰è¦æ±‚ä¸¤ä¸ªæ•°ä¸­çš„ä¸€ä¸ªæ•°ä¸èƒ½å¸¦å•ä½

   ```css
   .el {
     /* Valid ğŸ‘ */
     margin: calc(10px * 3);

     /* Valid ğŸ‘ */
     margin: calc(3 * 10px);

     /* Invalid ğŸ‘ */
     margin: calc(30px * 3px);
   }
   ```

4. åŠ å·ï¼ˆ+ï¼‰å’Œå‡å·ï¼ˆ-ï¼‰çš„å·¦å³ä¸¤è¾¹å¿…é¡»æœ‰ä¸€ä¸ªç©ºæ ¼

   ```css
   .el {
     /* Valid ğŸ‘ */
     font-size: calc(3vw + 2px);

     /* Invalid ğŸ‘ */
     font-size: calc(3vw+2px);

     /* Valid ğŸ‘ */
     font-size: calc(3vw - 2px);

     /* Invalid ğŸ‘ */
     font-size: calc(3vw-2px);
   }
   ```

   `calc()` ä¹Ÿæ”¯æŒè´Ÿæ•°ï¼š`calc(5vw - -5px)`

   ä¹˜æ³•å’Œé™¤æ³•ä¸éœ€è¦åœ¨è¿ç®—ç¬¦å‘¨å›´åŠ ç©ºæ ¼ï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿è®°å¿†å’Œé˜…è¯»ï¼Œè¿˜æ˜¯å»ºè®®éƒ½åŠ ä¸Šã€‚

   å…¶å®ƒç©ºæ ¼æ²¡ä»€ä¹ˆå½±å“ï¼Œå¦‚æœä½ æ„¿æ„çš„è¯ï¼Œè¿˜å¯ä»¥æ¢è¡Œï¼š

   ```css
   .el {
     /* Valid ğŸ‘ */
     width: calc(
       100%     /   3
     );
   }
   ```

   ä¸è¿‡ä¸€å®šè¦æ³¨æ„ï¼š`calc` ä¸å¼€å¤´æ‹¬å· `()` ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚

   ```css
   .el {
     /* Invalid ğŸ‘ */
     width: calc (100% / 3);
   }
   ```

## åµŒå¥— calc(calc())

ä½ è¿˜å¯ä»¥åµŒå¥—ä½¿ç”¨ `calc()` ï¼Œä½†æ˜¯å®Œå…¨æ²¡æœ‰è¿™ä¸ªå¿…è¦ã€‚å› ä¸ºä½ åŠ ä¸åŠ  `calc()` æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„

```css
.el {
  width: calc(
    calc(100% / 3)
    -
    calc(1rem * 2)
  );
}
```

ä¸€ä¸ª `calc()` é‡Œé¢çš„ `calc()` å°±ä»…ä»…ç›¸å½“äºæ˜¯ä¸€ä¸ªæ‹¬å·ã€‚

```css
.el {
  width: calc(
   (100% / 3)
    -
   (1rem * 2)
  );
}
```

åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼ŒåŠ ä¸åŠ åœ†æ‹¬å·éƒ½æ˜¯å¯ä»¥çš„ã€‚å› ä¸ºé™¤æ³•å’Œä¹˜æ³•çš„ä¼˜å…ˆçº§æ¯”åŠ å‡æ³•è¦é«˜ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š

```css
.el {
  width: calc(100% / 3 - 1rem * 2);
}
```

å¦‚æœä½ ç¡®å®éœ€è¦å…ˆåŠ å‡å†ä¹˜é™¤ï¼Œå°±éœ€è¦åŠ åœ†æ‹¬å·ã€‚

```css
.el {
  /* This */
  width: calc(100% + 2rem / 2);

  /* Is very different from this */
  width: calc((100% + 2rem) / 2);
}
```

## ä½¿ç”¨ CSS å˜é‡

`calc()` é™¤äº†å¯ä»¥æ··åˆå•ä½ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å’Œå˜é‡ä¸€èµ·ä½¿ç”¨ã€‚

```css
html {
  --spacing: 10px;
}

.module {
  padding: calc(var(--spacing) * 2);
}
```

å˜é‡ä¹Ÿå¯ä»¥äº’ç›¸å¼•ç”¨ã€‚

```css
html {
  --spacing: 10px;
  --spacing-L: var(--spacing) * 2;
  --spacing-XL: var(--spacing) * 3;
}

.module[data-spacing="XL"] {
  padding: calc(var(--spacing-XL));
}
```

å˜é‡å¯ä»¥æ¥è‡ª HTML

```html
<div style="--index: 1;"> ... </div>
<div style="--index: 2;"> ... </div>
<div style="--index: 3;"> ... </div>
```

```css
div {
  /* Index value comes from the HTML (with a fallback) */
  animation-delay: calc(var(--index, 1) * 0.2s);
}
```

éœ€è¦æ—¶å†æ·»åŠ å•ä½

å¦‚æœä½ éœ€è¦æå‰ç”¨æ— å•ä½çš„æ•°å­—è¿›è¡Œæ•°å­¦è¿ç®—ï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨ä½¿ç”¨æ•°å­—çš„æ—¶å€™å†ä¹˜ä»¥ä¸€ä¸ªå¸¦å•ä½çš„æ•°å­— 1ã€‚

```css
html {
  --importantNumber: 2;
}

.el {
  /* Number stays 2, but it has a unit now */
  padding: calc(var(--importantNumber) * 1rem);
}
```

æ”¹å˜é¢œè‰²

ä½ å¯ä»¥ä½¿ç”¨ `calc()` æ›´æ”¹ RGB å’Œ HSL ä¹‹ç±»çš„é¢œè‰²æ ¼å¼ä¸­çš„æ•°å­—æ¥æ”¹å˜é¢œè‰²ã€‚æ¯”å¦‚ï¼Œè®¾ç½®ä¸€äº›åŸºæœ¬çš„ HSL å€¼ï¼Œç„¶åæ›´æ”¹å®ƒä»¬ï¼š

```css
html {
  --H: 100;
  --S: 100%;
  --L: 50%;
}

.el {
  background: hsl(
    calc(var(--H) + 20),
    calc(var(--S) - 10%),
    calc(var(--L) + 30%)
  )
}
```

**æ„Ÿè°¢æ‚¨çš„è€å¿ƒé˜…è¯»ï¼**

**Thanks for reading!**
